<div class="flex min-h-screen bg-gray-900">

  <!-- Sidebar Component -->
  <app-sidebar></app-sidebar>

  <!-- Main Content -->
  <main class="flex-1 md:ml-64 p-6 bbh-sans-bartle-regular">

    <div class="max-w-4xl mx-auto space-y-6">
      
      <!-- Header -->
      <div class="mb-8">
        <h1 class="text-3xl font-bold text-white mb-2">Configurações</h1>
        <p class="text-gray-400">
          Gerencie suas informações pessoais e preferências
        </p>
      </div>

      <!-- Foto de Perfil -->
      <div class="bg-gray-800 border border-gray-700 rounded-lg p-6">
        <div class="mb-4">
          <h2 class="text-xl font-bold text-white mb-1">Foto de Perfil</h2>
          <p class="text-sm text-gray-400">Altere sua foto de perfil</p>
        </div>
        
        <div class="flex items-center gap-6">
          <!-- Avatar -->
          <div class="relative">
            <div *ngIf="fotoPreview" 
              class="w-24 h-24 rounded-full bg-blue-900/30 flex items-center justify-center text-blue-400 text-2xl font-bold border-2 border-blue-500/50">
              <img [src]="fotoPreview" alt="Preview"
              class="w-24 h-24 rounded-full object-cover border-2 border-gray-700">
            </div>

            <div *ngIf="!fotoPreview">
            <img 
              [src]="fotoUser()" 
              alt="Foto de perfil"
              class="w-24 h-24 rounded-full object-cover border-2 border-gray-700" />
              </div>
          </div>

          <!-- Upload Button -->
          <div>
            <label 
              for="photo-upload"
              class="inline-flex items-center gap-2 px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white font-medium rounded-lg cursor-pointer transition-colors">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" />
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z" />
              </svg>
              Alterar foto
            </label>
            
            <input
              id="photo-upload"
              type="file"
              #fileInput
              accept="image/*"
              class="hidden"
              (change)="oneFileSelected($event)" />
              
            <p class="text-sm text-gray-400 mt-2">
              JPG, PNG ou GIF. Máximo 5MB.
            </p>
          </div>
        </div>
      </div>

      <!-- Informações Pessoais (somente leitura) -->
      <div class="bg-gray-800 border border-gray-700 rounded-lg p-6">
        <div class="mb-4">
          <h2 class="text-xl font-bold text-white mb-1">Informações Pessoais</h2>
          <p class="text-sm text-gray-400">Suas informações básicas (somente leitura)</p>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <!-- Nome -->
          <div>
            <label class="block text-sm font-semibold text-gray-400 mb-2">Nome Completo</label>
            <input 
              type="text" 
              [value]="nomeUsuario()"
              disabled
              class="w-full px-4 py-2 bg-gray-900/50 border border-gray-700 text-gray-500 rounded-lg cursor-not-allowed" />
          </div>

          <!-- Email -->
          <div>
            <label class="block text-sm font-semibold text-gray-400 mb-2">Email</label>
            <input 
              type="email" 
              [value]="emailUser()"
              disabled
              class="w-full px-4 py-2 bg-gray-900/50 border border-gray-700 text-gray-500 rounded-lg cursor-not-allowed" />
          </div>

          <!-- CPF -->
          <div>
            <label class="block text-sm font-semibold text-gray-400 mb-2">CPF</label>
            <input 
              type="text" 
              [value]="cpfUser()"
              disabled
              class="w-full px-4 py-2 bg-gray-900/50 border border-gray-700 text-gray-500 rounded-lg cursor-not-allowed" />
          </div>
        </div>
      </div>

      <!-- Contato e Endereço (editável) -->
      <div class="bg-gray-800 border border-gray-700 rounded-lg p-6">
        <div class="flex items-center justify-between mb-4">
          <div>
            <h2 class="text-xl font-bold text-white mb-1">Contato e Endereço</h2>
            <p class="text-sm text-gray-400">Informações que você pode editar</p>
          </div>
          <button 
            *ngIf="!isEditingProfile"
            (click)="startEditingProfile()"
            class="px-4 py-2 bg-gray-700 hover:bg-gray-600 border border-gray-600 text-white font-medium rounded-lg transition-colors">
            Editar
          </button>
        </div>

        <form [formGroup]="form" (ngSubmit)="editInfo()">
          <div class="space-y-4">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              
              <!-- Telefone -->
              <div>
                <label class="block text-sm font-semibold text-gray-400 mb-2">
                  Telefone *
                </label>
                <input 
                  type="number" 
                  formControlName="telefone"
                  [disabled]="!isEditingProfile"
                  placeholder="(11) 98765-4321"
                  [class.bg-gray-900/50]="!isEditingProfile"
                  [class.text-gray-500]="!isEditingProfile"
                  [class.cursor-not-allowed]="!isEditingProfile"
                  [class.border-red-500]="form.get('telefone')?.invalid && form.get('telefone')?.touched && isEditingProfile"
                  class="w-full px-4 py-2 bg-gray-900 border border-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" />
                <p *ngIf="form.get('telefone')?.invalid && form.get('telefone')?.touched && isEditingProfile" 
                   class="text-red-500 text-xs mt-1">
                  Formato inválido. Use: (11) 98765-4321
                </p>
              </div>

              <div>
                <label class="block text-sm font-semibold text-gray-400 mb-2">
                  Bairro
                </label>
                <input 
                  type="text" 
                  formControlName="bairro"
                  [disabled]="!isEditingProfile"
                  placeholder="ex: Cabral"
                  [class.bg-gray-900/50]="!isEditingProfile"
                  [class.text-gray-500]="!isEditingProfile"
                  [class.cursor-not-allowed]="!isEditingProfile"
                  [class.border-red-500]="form.get('bairro')?.invalid && form.get('bairro')?.touched && isEditingProfile"
                  class="w-full px-4 py-2 bg-gray-900 border border-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" />
                <p *ngIf="form.get('bairro')?.invalid && form.get('bairro')?.touched && isEditingProfile" 
                   class="text-red-500 text-xs mt-1">
                  Formato inválido. Use: (11) 98765-4321
                </p>
              </div>

              <div>
                <label class="block text-sm font-semibold text-gray-400 mb-2">
                  Complemento
                </label>
                <input 
                  type="text" 
                  formControlName="complemento"
                  [disabled]="!isEditingProfile"
                  placeholder="ex: Casa"
                  [class.bg-gray-900/50]="!isEditingProfile"
                  [class.text-gray-500]="!isEditingProfile"
                  [class.cursor-not-allowed]="!isEditingProfile"
                  [class.border-red-500]="form.get('complemento')?.invalid && form.get('complemento')?.touched && isEditingProfile"
                  class="w-full px-4 py-2 bg-gray-900 border border-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" />
                <p *ngIf="form.get('complemento')?.invalid && form.get('bairro')?.touched && isEditingProfile" 
                   class="text-red-500 text-xs mt-1">
                  Formato inválido. Use: (11) 98765-4321
                </p>
              </div>

              <!-- Endereço -->
              <div class="md:col-span-2">
                <label class="block text-sm font-semibold text-gray-400 mb-2">
                  Endereço *
                </label>
                <input 
                  type="text" 
                  formControlName="logradouro"
                  [disabled]="!isEditingProfile"
                  placeholder="Rua Exemplo, 123"
                  [class.bg-gray-900/50]="!isEditingProfile"
                  [class.text-gray-500]="!isEditingProfile"
                  [class.cursor-not-allowed]="!isEditingProfile"
                  [class.border-red-500]="form.get('logradouro')?.invalid && form.get('logradouro')?.touched && isEditingProfile"
                  class="w-full px-4 py-2 bg-gray-900 border border-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" />
                <p *ngIf="form.get('logradouro')?.invalid && form.get('logradouro')?.touched && isEditingProfile" 
                   class="text-red-500 text-xs mt-1">
                  Endereço deve ter no mínimo 5 caracteres
                </p>
              </div>

              

              <!-- Cidade -->
              <div>
                <label class="block text-sm font-semibold text-gray-400 mb-2">
                  Cidade *
                </label>
                <input 
                  type="text" 
                  formControlName="cidade"
                  [disabled]="!isEditingProfile"
                  placeholder="São Paulo"
                  [class.bg-gray-900/50]="!isEditingProfile"
                  [class.text-gray-500]="!isEditingProfile"
                  [class.cursor-not-allowed]="!isEditingProfile"
                  [class.border-red-500]="form.get('cidade')?.invalid && form.get('cidade')?.touched && isEditingProfile"
                  class="w-full px-4 py-2 bg-gray-900 border border-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" />
                <p *ngIf="form.get('cidade')?.invalid && form.get('cidade')?.touched && isEditingProfile" 
                   class="text-red-500 text-xs mt-1">
                  Cidade é obrigatória
                </p>
              </div>

              <!-- Estado -->
              <div>
                <label class="block text-sm font-semibold text-gray-400 mb-2">
                  Estado *
                </label>
                <input 
                  type="text" 
                  formControlName="estado"
                  [disabled]="!isEditingProfile"
                  placeholder="SP"
                  [class.bg-gray-900/50]="!isEditingProfile"
                  [class.text-gray-500]="!isEditingProfile"
                  [class.cursor-not-allowed]="!isEditingProfile"
                  [class.border-red-500]="form.get('estado')?.invalid && form.get('estado')?.touched && isEditingProfile"
                  class="w-full px-4 py-2 bg-gray-900 border border-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" />
                <p *ngIf="form.get('estado')?.invalid && form.get('estado')?.touched && isEditingProfile" 
                   class="text-red-500 text-xs mt-1">
                  UF com 2 caracteres (ex: SP)
                </p>
              </div>

              <!-- CEP -->
              <div>
                <label class="block text-sm font-semibold text-gray-400 mb-2">
                  CEP *
                </label>
                <input 
                  type="text" 
                  formControlName="cep"
                  (keyup)="cepKeyUp($event)"
                  [disabled]="!isEditingProfile"
                  placeholder="01234-567"
                  [class.bg-gray-900/50]="!isEditingProfile"
                  [class.text-gray-500]="!isEditingProfile"
                  [class.cursor-not-allowed]="!isEditingProfile"
                  [class.border-red-500]="form.get('cep')?.invalid && form.get('cep')?.touched && isEditingProfile"
                  class="w-full px-4 py-2 bg-gray-900 border border-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" />
                <p *ngIf="form.get('cep')?.invalid && form.get('cep')?.touched && isEditingProfile" 
                   class="text-red-500 text-xs mt-1">
                  Formato inválido. Use: 01234-567
                </p>
              </div>

              <div>
                <label class="block text-sm font-semibold text-gray-400 mb-2">
                  Número *
                </label>
                <input 
                  type="text" 
                  formControlName="numero"
                  [disabled]="!isEditingProfile"
                  placeholder="01234-567"
                  [class.bg-gray-900/50]="!isEditingProfile"
                  [class.text-gray-500]="!isEditingProfile"
                  [class.cursor-not-allowed]="!isEditingProfile"
                  [class.border-red-500]="form.get('numero')?.invalid && form.get('numero')?.touched && isEditingProfile"
                  class="w-full px-4 py-2 bg-gray-900 border border-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" />
                <p *ngIf="form.get('numero')?.invalid && form.get('numero')?.touched && isEditingProfile" 
                   class="text-red-500 text-xs mt-1">
                  Formato inválido. Use: 01234-567
                </p>
              </div>
            </div>

            <!-- Botões de Salvar/Cancelar -->
            <div *ngIf="isEditingProfile || selectedFile" class="flex gap-2 pt-2">
              <button
                type="submit"
                class="px-6 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white font-semibold rounded-lg transition-colors">
                Salvar alterações
              </button>
              <button 
                type="button"
                (click)="handleCancelEdit()"
                class="px-6 py-2 bg-gray-700 hover:bg-gray-600 border border-gray-600 text-white font-semibold rounded-lg transition-colors">
                Cancelar
              </button>
            </div>
          </div>
        </form>
      </div>

      <!-- Formas de Pagamento -->
      <div class="bg-gray-800 border border-gray-700 rounded-lg p-6">
        <div class="flex items-center justify-between mb-4">
          <div>
            <h2 class="text-xl font-bold text-white mb-1">Formas de Pagamento</h2>
            <p class="text-sm text-gray-400">Gerencie suas opções de pagamento</p>
          </div>
          <button 
            (click)="handleAddPaymentMethod()"
            class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-colors flex items-center gap-2">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
            </svg>
            Adicionar
          </button>
        </div>

        <div class="space-y-3">
          <!-- Lista de métodos de pagamento -->
          <div 

            class="flex items-center justify-between p-4 border border-gray-700 rounded-lg bg-gray-900 hover:bg-gray-700 transition-colors">
            
            <div class="flex items-center gap-3">
              <div class="p-2 rounded-full bg-blue-900/30">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z" />
                </svg>
              </div>
              <div>
                <p class="font-medium text-white"></p>
                <p class="text-sm text-gray-400">
                </p>
              </div>
            </div>

            <button
              (click)="handleRemovePaymentMethod('abc')"
              class="p-2 hover:bg-gray-600 rounded-lg transition-colors">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
              </svg>
            </button>
          </div>

          <!-- Estado vazio -->
          <!-- <p *ngIf="paymentMethods.length === 0" class="text-center text-gray-400 py-8">
            Nenhuma forma de pagamento cadastrada
          </p> -->
        </div>
      </div>

    </div>

    <!-- Toast Notification -->
    <div *ngIf="toastVisible"
      class="fixed bottom-4 right-4 bg-gray-800 border border-gray-700 rounded-lg shadow-2xl p-4 max-w-sm animate-slide-up z-50">
      <h4 class="text-white font-bold mb-1">{{ toastTitle }}</h4>
      <p class="text-gray-300 text-sm">{{ toastMessage }}</p>
    </div>

  </main>

</div>